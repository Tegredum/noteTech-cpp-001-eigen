# 部分关键算法实现位置

encoding: utf-8

author: Fitten Code（DeepSeek R1）

Eigen库中矩阵求逆的实现主要位于以下文件：

1. **核心实现逻辑的位置**：
   - `Eigen/src/LU/InverseImpl.h`
   - 该文件包含了不同矩阵大小（固定大小 vs 动态大小）的求逆特化实现，是逆计算的分发中心。

2. **关键代码段**：

   ```cpp
   // 小矩阵直接计算（如2x2, 3x3, 4x4）
   template<> template<typename MType>
   void Inverse<MType, 1>::evalTo(ResultType& result) const {
       // 伴随矩阵除以行列式的经典公式
       result.coeffRef(0,0) = Scalar(1) / m_matrix.coeff(0,0);
   }

   // 动态大小或大矩阵通过LU分解求逆
   template<> template<typename MType>
   void Inverse<MType, Dynamic>::evalTo(ResultType& result) const {
       PartialPivLU<MatrixType> lu(m_matrix);
       result = lu.inverse();
   }
   ```

3. **调用链路**：
   - 用户调用 `matrix.inverse()` 时，触发 `MatrixBase::inverse()`（定义在 `Eigen/src/Core/MatrixBase.h`）。
   - 生成一个延迟计算的逆表达式（定义在 `Eigen/src/Core/Inverse.h`）。
   - 当需要显式计算时（如赋值给具体矩阵），调用 `InverseImpl.h` 中的特化实现。

4. **分解依赖**：
   - 动态大小矩阵的逆通过 `PartialPivLU`（部分选主元LU分解）实现，代码位于：
     - `Eigen/src/LU/PartialPivLU.h`
     - `PartialPivLU::inverse()` 方法会调用 `solve()` 解算单位矩阵以得到逆矩阵。

**总结**：Eigen的逆计算针对小矩阵（≤4x4）直接优化，大矩阵通过LU分解间接求解，核心逻辑集中在 `InverseImpl.h` 和 `PartialPivLU` 模块中。
